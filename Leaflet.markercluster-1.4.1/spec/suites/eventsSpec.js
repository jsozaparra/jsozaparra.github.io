describe("events",function(){var e,r,a;beforeEach(function(){(e=document.createElement("div")).style.width="200px",e.style.height="200px",document.body.appendChild(e),(r=L.map(e,{maxZoom:18,trackResize:!1})).fitBounds(new L.LatLngBounds([[1,1],[2,2]]))}),afterEach(function(){a instanceof L.MarkerClusterGroup&&(a.removeLayers(a.getLayers()),r.removeLayer(a)),r.remove(),e.remove(),e=r=a=null}),it("is fired for a single child marker",function(){var e=sinon.spy();a=new L.MarkerClusterGroup;var n=new L.Marker([1.5,1.5]);a.on("click",e),a.addLayer(n),r.addLayer(a),n.fire("click",null,!0),expect(e.called).to.be(!0)}),it("is fired for a child polygon",function(){var e=sinon.spy();a=new L.MarkerClusterGroup;var n=new L.Polygon([[1.5,1.5],[2,1.5],[2,2],[1.5,2]]);a.on("click",e),a.addLayer(n),r.addLayer(a),n.fire("click",null,!0),expect(e.called).to.be(!0)}),it("is fired for a cluster click",function(){var e=sinon.spy();a=new L.MarkerClusterGroup;var n=new L.Marker([1.5,1.5]),o=new L.Marker([1.5,1.5]);a.on("clusterclick",e),a.addLayers([n,o]),r.addLayer(a);var t=a.getVisibleParent(n);expect(t instanceof L.MarkerCluster).to.be(!0),t.fire("click",null,!0),expect(e.called).to.be(!0)}),describe("after being added, removed, re-added from the map",function(){it("still fires events for nonpoint data",function(){var e=sinon.spy();a=new L.MarkerClusterGroup;var n=new L.Polygon([[1.5,1.5],[2,1.5],[2,2],[1.5,2]]);a.on("click",e),a.addLayer(n),r.addLayer(a),r.removeLayer(a),r.addLayer(a),n.fire("click",null,!0),expect(e.called).to.be(!0)}),it("still fires events for point data",function(){var e=sinon.spy();a=new L.MarkerClusterGroup;var n=new L.Marker([1.5,1.5]);a.on("click",e),a.addLayer(n),r.addLayer(a),r.removeLayer(a),r.addLayer(a),n.fire("click",null,!0),expect(e.called).to.be(!0)}),it("still fires cluster events",function(){var e=sinon.spy();a=new L.MarkerClusterGroup;var n=new L.Marker([1.5,1.5]),o=new L.Marker([1.5,1.5]);a.on("clusterclick",e),a.addLayers([n,o]),r.addLayer(a),r.removeLayer(a),r.addLayer(a);var t=a.getVisibleParent(n);expect(t instanceof L.MarkerCluster).to.be(!0),t.fire("click",null,!0),expect(e.called).to.be(!0)}),it("does not break map events",function(){var e=sinon.spy();a=new L.MarkerClusterGroup,r.on("zoomend",e),r.addLayer(a),r.removeLayer(a),r.addLayer(a),r.fire("zoomend"),expect(e.called).to.be(!0)}),it("fires layeradd when markers are added while not on the map",function(){var e=sinon.spy();(a=new L.MarkerClusterGroup).on("layeradd",e);var r=new L.Marker([1.5,1.5]);a.addLayer(r),expect(e.callCount).to.be(1)}),it("fires layeradd when vectors are added while not on the map",function(){var e=sinon.spy();(a=new L.MarkerClusterGroup).on("layeradd",e);var r=new L.Polygon([[1.5,1.5],[2,1.5],[2,2],[1.5,2]]);a.addLayer(r),expect(e.callCount).to.be(1)}),it("fires layeradd when markers are added while on the map",function(){var e=sinon.spy();(a=new L.MarkerClusterGroup).on("layeradd",e),r.addLayer(a);var n=new L.Marker([1.5,1.5]);a.addLayer(n),expect(e.callCount).to.be(1)}),it("fires layeradd when vectors are added while on the map",function(){var e=sinon.spy();(a=new L.MarkerClusterGroup).on("layeradd",e),r.addLayer(a);var n=new L.Polygon([[1.5,1.5],[2,1.5],[2,2],[1.5,2]]);a.addLayer(n),expect(e.callCount).to.be(1)}),it("fires layeradd when markers are added using addLayers while on the map with chunked loading",function(){var e=sinon.spy();(a=new L.MarkerClusterGroup({chunkedLoading:!0})).on("layeradd",e),r.addLayer(a);var n=new L.Marker([1.5,1.5]);a.addLayers([n]),expect(e.callCount).to.be(1)}),it("fires layeradd when vectors are added using addLayers while on the map with chunked loading",function(){var e=sinon.spy();(a=new L.MarkerClusterGroup({chunkedLoading:!0})).on("layeradd",e),r.addLayer(a);var n=new L.Polygon([[1.5,1.5],[2,1.5],[2,2],[1.5,2]]);a.addLayers([n]),expect(e.callCount).to.be(1)}),it("fires layerremove when a marker is removed while not on the map",function(){var e=sinon.spy();(a=new L.MarkerClusterGroup).on("layerremove",e);var r=new L.Marker([1.5,1.5]);a.addLayer(r),a.removeLayer(r),expect(e.callCount).to.be(1)}),it("fires layerremove when a vector is removed while not on the map",function(){var e=sinon.spy();(a=new L.MarkerClusterGroup).on("layerremove",e);var r=new L.Polygon([[1.5,1.5],[2,1.5],[2,2],[1.5,2]]);a.addLayer(r),a.removeLayer(r),expect(e.callCount).to.be(1)}),it("fires layerremove when a marker is removed while on the map",function(){var e=sinon.spy();(a=new L.MarkerClusterGroup).on("layerremove",e),r.addLayer(a);var n=new L.Marker([1.5,1.5]);a.addLayer(n),a.removeLayer(n),expect(e.callCount).to.be(1)}),it("fires layerremove when a vector is removed while on the map",function(){var e=sinon.spy();(a=new L.MarkerClusterGroup).on("layerremove",e),r.addLayer(a);var n=new L.Polygon([[1.5,1.5],[2,1.5],[2,2],[1.5,2]]);a.addLayer(n),a.removeLayer(n),expect(e.callCount).to.be(1)}),it("fires layerremove when a marker is removed using removeLayers while on the map with chunked loading",function(){var e=sinon.spy();(a=new L.MarkerClusterGroup({chunkedLoading:!0})).on("layerremove",e),r.addLayer(a);var n=new L.Marker([1.5,1.5]);a.addLayers([n]),a.removeLayers([n]),expect(e.callCount).to.be(1)}),it("fires layerremove when a vector is removed using removeLayers while on the map with chunked loading",function(){var e=sinon.spy();(a=new L.MarkerClusterGroup({chunkedLoading:!0})).on("layerremove",e),r.addLayer(a);var n=new L.Polygon([[1.5,1.5],[2,1.5],[2,2],[1.5,2]]);a.addLayers([n]),a.removeLayers([n]),expect(e.callCount).to.be(1)}),it("fires layerremove when a marker is removed using removeLayers while not on the map with chunked loading",function(){var e=sinon.spy();(a=new L.MarkerClusterGroup({chunkedLoading:!0})).on("layerremove",e);var r=new L.Marker([1.5,1.5]);a.addLayers([r]),a.removeLayers([r]),expect(e.callCount).to.be(1)}),it("fires layerremove when a vector is removed using removeLayers while not on the map with chunked loading",function(){var e=sinon.spy();(a=new L.MarkerClusterGroup({chunkedLoading:!0})).on("layerremove",e);var r=new L.Polygon([[1.5,1.5],[2,1.5],[2,2],[1.5,2]]);a.addLayers([r]),a.removeLayers([r]),expect(e.callCount).to.be(1)})})});